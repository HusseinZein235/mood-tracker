<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة المدير - تتبع المزاج</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="card admin-card">
            <div class="card-header">
                <h1><i class="fas fa-chart-bar"></i> لوحة المدير</h1>
                <a href="/dashboard" class="back-btn"><i class="fas fa-arrow-right"></i> العودة </a>
            </div>
            <div class="card-body">
                <div class="admin-intro">
                    <h2>مرحباً بك في لوحة المدير</h2>
                    <p>هنا يمكنك رؤية إحصائيات المستخدمين وتحليل بيانات المزاج.</p>
                </div>
                
                <div class="stats-overview">
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stats-info">
                            <h3 id="totalUsers">0</h3>
                            <p>إجمالي المستخدمين</p>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-smile"></i>
                        </div>
                        <div class="stats-info">
                            <h3 id="totalMoods">0</h3>
                            <p>إجمالي سجلات المزاج</p>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stats-info">
                            <h3 id="avgMoodsPerUser">0</h3>
                            <p>متوسط السجلات لكل مستخدم</p>
                        </div>
                    </div>
                </div>
                
                <!-- Mood Statistics Section -->
                <div class="mood-statistics">
                    <div class="mood-stats-card">
                        <h3>توزيع المزاج</h3>
                        <div class="stats-list" id="moodDistributionStats">
                            <div class="stat-item">
                                <div class="stat-label">
                                    <i class="fas fa-smile" style="color: #4CAF50;"></i>
                                    <span>سعيد</span>
                                </div>
                                <div class="stat-value">0%</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">
                                    <i class="fas fa-meh" style="color: #FFC107;"></i>
                                    <span>محايد</span>
                                </div>
                                <div class="stat-value">0%</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">
                                    <i class="fas fa-frown" style="color: #F44336;"></i>
                                    <span>حزين</span>
                                </div>
                                <div class="stat-value">0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mood-stats-card">
                        <h3>أسباب المزاج (المتوسط)</h3>
                        <div class="stats-list" id="moodReasonsStats">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
                
                <!-- Mood Evolution Over Time Section -->
                <div class="mood-evolution-section">
                    <div class="mood-evolution-card">
                        <h3>تطور المزاج عبر الزمن</h3>
                        <div class="chart-container">
                            <canvas id="moodEvolutionChart"></canvas>
                        </div>
                        <div class="chart-filters">
                            <div class="form-group">
                                <label for="timeRangeSelect">المدة الزمنية:</label>
                                <select id="timeRangeSelect" class="chart-filter">
                                    <option value="7">آخر 7 أيام</option>
                                    <option value="30" selected>آخر 30 يوم</option>
                                    <option value="90">آخر 3 أشهر</option>
                                    <option value="all">الكل</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="admin-users">
                    <div class="users-header">
                        <h3>المستخدمون</h3>
                        <input type="text" id="userSearchInput" placeholder="البحث عن مستخدم...">
                    </div>
                    
                    <div class="users-table-container">
                        <table class="users-table">
                            <thead>
                                <tr>
                                    <th>اسم المستخدم</th>
                                    <th>الاسم</th>
                                    <th>عدد السجلات</th>
                                    <th>آخر تسجيل</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <!-- Users will be added here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="user-details" id="userDetails">
                    <div class="user-details-header">
                        <h3 id="selectedUserName">تفاصيل المستخدم</h3>
                        <div class="user-actions">
                            <button id="deleteUserBtn" class="btn btn-danger"><i class="fas fa-trash"></i> حذف المستخدم</button>
                            <button id="closeUserDetailsBtn" class="btn btn-secondary"><i class="fas fa-times"></i> إغلاق</button>
                        </div>
                    </div>
                    
                    <div class="user-info">
                        <p><strong>اسم المستخدم:</strong> <span id="detailsUsername"></span></p>
                        <p><strong>الاسم:</strong> <span id="detailsName"></span></p>
                        <p><strong>البريد الإلكتروني:</strong> <span id="detailsEmail"></span></p>
                        <p><strong>الوصف:</strong> <span id="detailsDescription"></span></p>
                        <p><strong>عدد السجلات:</strong> <span id="detailsRecordCount"></span></p>
                        <p><strong>تاريخ التسجيل:</strong> <span id="detailsCreatedAt"></span></p>
                    </div>
                    
                    <div class="user-mood-stats">
                        <h4>إحصائيات المزاج</h4>
                        <div class="user-mood-distribution">
                            <div class="stat-item">
                                <div class="stat-label">
                                    <i class="fas fa-smile" style="color: #4CAF50;"></i>
                                    <span>سعيد</span>
                                </div>
                                <div class="stat-value" id="userHappyPercent">0%</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">
                                    <i class="fas fa-meh" style="color: #FFC107;"></i>
                                    <span>محايد</span>
                                </div>
                                <div class="stat-value" id="userNeutralPercent">0%</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">
                                    <i class="fas fa-frown" style="color: #F44336;"></i>
                                    <span>حزين</span>
                                </div>
                                <div class="stat-value" id="userSadPercent">0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="user-moods-table-container">
                        <h4>سجلات المزاج</h4>
                        <table class="moods-table">
                            <thead>
                                <tr>
                                    <th>التاريخ</th>
                                    <th>المزاج العام</th>
                                    <th>المزاج المحدد</th>
                                    <th>السبب</th>
                                </tr>
                            </thead>
                            <tbody id="userMoodsTableBody">
                                <!-- Moods will be added here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal" id="deleteConfirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>تأكيد الحذف</h3>
                <button class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <p>هل أنت متأكد من أنك تريد حذف هذا المستخدم؟ سيتم حذف جميع بيانات المستخدم بشكل نهائي.</p>
            </div>
            <div class="modal-footer">
                <button id="confirmDeleteBtn" class="btn btn-danger">حذف</button>
                <button id="cancelDeleteBtn" class="btn btn-secondary">إلغاء</button>
            </div>
        </div>
    </div>

    <div class="alert" id="alert"></div>

    <script src="/js/admin.js"></script>
</body>
</html> 